<%- include_stylesheet 'admin/nice_assets' -%>
<%- include_javascript 'admin/jquery-1.3.2.min' -%>
<%- include_javascript 'admin/jquery_no_conflict' -%>
<%- include_javascript 'admin/jquery.tablesorter.min.js' -%>

<div id="asset_list_wrapper">
  <table id="asset_list">
    <thead>
      <tr>
        <th scope="col">Asset</th>
        <th scope="col">Filename</th>
        <th scope="col">Date</th>
        <th scope="col">Title</th>
        <th scope="col">#</th>
        <th scope="col">Pages</th>
        <th scope="col">Actions</th>
      </tr>
    </thead>
    <tbody>
      <%- @assets.each do |asset| -%>
        <tr>
          <td>
            <div class="asset">
              <%- if asset.image? -%>
                <%= link_to(image_tag(asset.public_filename(:icon)), asset.public_filename, :target => "_blank") %>
              <%- else -%>  
              
              <%- end -%>
            </div>
          </td>
          <td><%= asset.filename %></td>
          </td>
          <td class="date"><%= asset.created_at.to_date %></td>
          <td><%= asset.title %></td>
          <td><%= asset.page_associations.length %></td>
          <td>
            <%- unless asset.page_associations.blank? -%>
              <ul>
              <%- asset.page_associations.each do |pa| -%>
                <li><%= link_to(pa.page.url, "/admin/pages/#{pa.page.id}/edit") %></li>
              <%- end -%>
              </ul>
            <%- end -%>
          </td>
          <td>
            DELETE
          </td>
        </tr>
      <%- end -%>
    </tbody>
  </table>
</div> <!-- #asset_list_wrapper -->

<script type="text/javascript" charset="utf-8">
jQuery(document).ready(function() {
  var first_body_row = jQuery('#asset_list tbody tr:first td');
  var header_row = jQuery('#asset_list thead tr:first th');
  // alert(first_body_row.eq(0).width());
  
  var length = first_body_row.length;
  for (i=0; i < length; i++) {
    header_row.eq(i).css('width', first_body_row.eq(i).css('width'));
  }
  // var i = 0;
  // first_body_row.each(function() {
  //   alert($(this).css('width'));
  //   width = $(this).width();
  //   // alert(header_row.eq(i).text());
  //   // header_row.eq(i).css('width', width);
  //   i++;
  // });
  
  jQuery("#asset_list").tablesorter({
    sortList: [[2,1]],
    headers: {
      0: {sorter: false},
      5: {sorter: false},
      6: {sorter: false}
    }
  });
});
</script>