<ul>
<% node.children.each do |child|
  icon_name = child.virtual? ? "virtual-page" : "page"
  icon = image(icon_name, :class => "icon", :alt => 'page-icon', :title => '', :align => 'center')
%>
  <li id="node-<%= child.id %>">
  <% if child.children.length > 0 -%>
    <%= link_to_remote '<span class="hidden">+</span>', {:url => {:controller => 'admin/nice_assets', :action => 'browse_pages', :page => @page.id, :node => child.id}, :before => %{this.addClassName('spinner')}}, :class => 'expander' %>
    <%= icon %>
    <%= link_to_remote child.title, :url => {:controller => 'admin/nice_assets', :action => 'link_page', :id => @current_page, :page => child.id}, :before => %{Element.show('page-browse-loading')} %>
  <% else -%>
    <span class="expander-placeholder"></span> <%= icon %>
    <%= link_to_remote child.title, :url => {:controller => 'admin/nice_assets', :action => 'link_page', :id => @current_page, :page => child.id}, :before => %{Element.show('page-browse-loading')} %>
  <% end -%>
<% end %>
</ul>